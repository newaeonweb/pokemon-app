<div class="container">
  <div fxLayout="row" fxLayoutAlign="center start">
    <h1 translate>Pokemon Cards</h1>
  </div>
  <!-- <div fxLayout="row wrap" fxLayoutGap="16px grid" fxLayout.lt-sm="column" fxLayoutAlign="space-between center">
    <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="100%">
      <mat-form-field>
        <mat-label><span translate>Filter by supertypes</span></mat-label>
        <mat-select [(ngModel)]="filters.supertypes">
          <mat-option><span translate>All</span></mat-option>
          <mat-option *ngFor="let supertypes of supertypesList" [value]="supertypes"> {{ supertypes }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="100%">
      <mat-form-field>
        <mat-label><span translate>Filter by types</span></mat-label>
        <mat-select [(ngModel)]="filters.types">
          <mat-option><span translate>All</span></mat-option>
          <mat-option *ngFor="let types of typesList" [value]="types"> {{ types }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="100%">
      <mat-form-field>
        <mat-label><span translate>Filter by subtypes</span></mat-label>
        <mat-select [(ngModel)]="filters.subtypes">
          <mat-option><span translate>All</span></mat-option>
          <mat-option *ngFor="let subtypes of subtypesList" [value]="subtypes"> {{ subtypes }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div fxLayout="row wrap" fxLayoutAlign="space-between center">
      <button fxFlex mat-flat-button color="primary" (click)="applyAllFilters()">
        <span translate>Apply Filters</span>
      </button>
      <button fxFlex mat-button color="primary" (click)="clearFilters()">
        <span translate>Clear Filters</span>
      </button>
    </div>
  </div>

  <br /> -->

  <div class="flex-container">
    <mat-form-field>
      <mat-label>Search characters by name</mat-label>
      <input matInput #search (keyup)="dispatchSearch(search.value)" [formControl]="searchField" />
      <button
        type="text"
        mat-button
        *ngIf="search.value !== ''"
        matSuffix
        mat-icon-button
        aria-label="Clear"
        (click)="clearSearch()"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
    <small class="no-character-found" *ngIf="resultsEmpty$ | async"> No character found for this search </small>
  </div>

  <div fxLayout="row wrap" fxLayoutGap="6px" fxLayoutAlign="center center">
    <div fxFlex="20">
      <mat-form-field appearance="fill">
        <mat-label><span translate>Filter by supertypes</span></mat-label>
        <mat-select [formControl]="supertypeValueFormControl">
          <mat-option [value]="''"><span translate>All</span></mat-option>
          <mat-option *ngFor="let supertypes of supertypesList" [value]="supertypes"> {{ supertypes }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div fxFlex>
      <mat-form-field appearance="fill">
        <mat-label><span translate>Filter by types</span></mat-label>
        <mat-select [formControl]="typesValueFormControl">
          <mat-option [value]="''"><span translate>All</span></mat-option>
          <mat-option *ngFor="let types of typesList" [value]="types"> {{ types }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div fxFlex>
      <mat-form-field appearance="fill">
        <mat-label><span translate>Filter by subtypes</span></mat-label>
        <mat-select [formControl]="subtypesIdValueFormControl">
          <mat-option [value]="''"><span translate>All</span></mat-option>
          <mat-option *ngFor="let subtypes of subtypesList" [value]="subtypes"> {{ subtypes }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div fxFlex>
      <mat-form-field appearance="fill">
        <mat-label><span translate>Filter by set</span></mat-label>
        <mat-select [formControl]="setIdValueFormControl">
          <input class="select-search" matInput [(ngModel)]="searchLisText" matInput placeholder="Type set name" />
          <button
            class="select-search-button"
            mat-button
            *ngIf="searchLisText !== ''"
            matSuffix
            mat-icon-button
            aria-label="Clear"
            (click)="searchLisText = ''"
          >
            <mat-icon>close</mat-icon>
          </button>
          <mat-option [value]="''"><span translate>All</span></mat-option>
          <mat-option *ngFor="let set of setList | selectSearch: searchLisText" [value]="set.name">
            <span class="set-symbol"> <img [src]="set.images.symbol" alt="symbol" /> </span> {{ set.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div *ngIf="characters$ | async as cardsList; else loading">
    <div class="card-content">
      <div
        fxLayout="row wrap"
        fxLayoutGap="16px grid"
        fxLayout.lt-sm="column"
        fxLayoutAlign="start center"
        fxLayoutAlign.lt-sm="start center"
      >
        <ng-container *ngFor="let card of cardsList">
          <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="100%">
            <mat-card class="mat-elevation-z3">
              <mat-card-header>
                <mat-card-title>
                  <div fxLayout="row" fxLayoutAlign="space-between center">
                    <span fxFlex> {{ card.name }}</span>
                    <small [hidden]="!card.hp">HP: {{ card.hp }}</small>
                  </div>
                </mat-card-title>
                <mat-card-subtitle>
                  <div fxLayout="column" fxLayoutAlign="start start">
                    <p><strong>Set:</strong> {{ card.set.name }}</p>
                    <p><strong>Series:</strong> {{ card.set.series }}</p>
                  </div>
                  <mat-divider></mat-divider>
                </mat-card-subtitle>
                <mat-card-subtitle>
                  <p>
                    <strong> Supertype:</strong> {{ card.supertype }} <br />
                    <strong> Subtypes:</strong>
                    <span *ngFor="let item of card.subtypes">{{ item }}</span> <br />

                    <span *ngFor="let item of card.types">
                      <strong>Types:</strong>
                      {{ item }}
                    </span>
                  </p>
                </mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <div class="img-placeholder">
                  <img src="{{ card.images.small }}" alt="{{ card.name }}" loading="lazy" />
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
  <ng-template #loading>
    <div fxLayout="row" fxLayoutAlign="center start">
      <app-loader isLoading="true"></app-loader>
    </div>
  </ng-template>
  <br />
  <mat-paginator
    #paginator
    [length]="resultsLength"
    [pageSize]="queryParams?.pageSize"
    [pageSizeOptions]="[5, 10, 20]"
    showFirstLastButtons
  >
  </mat-paginator>
</div>
